(this["webpackJsonpchat-app"]=this["webpackJsonpchat-app"]||[]).push([[0],{194:function(e,t,n){},272:function(e,t,n){"use strict";n.r(t);var a=n(0),c=n.n(a),i=n(41),s=n.n(i),o=(n(194),n(1)),r=n.n(o),l=n(2),u=n(280),d=n(275),j=n(276),b=n(83),p=n(114),h=n(185),m=(n(195),n(273),p.a.initializeApp({apiKey:"AIzaSyDAZ0UDDoyO6Q7nUYRjTkAFzGd-C9fOm2Y",authDomain:"chat-app-dbc83.firebaseapp.com",projectId:"chat-app-dbc83",storageBucket:"chat-app-dbc83.appspot.com",messagingSenderId:"656128365474",appId:"1:656128365474:web:c95a0e75be310eb976d8fb",measurementId:"G-3BY0G5VWYJ"}));Object(h.a)(m);var O=p.a.auth(),f=p.a.firestore();"localhost"===window.location.hostname&&(O.useEmulator("http://localhost:9099"),f.useEmulator("127.0.0.1","8080"));var x=p.a,v=n(40),g=n(61);function y(e,t){f.collection(e).add(Object(g.a)(Object(g.a)({},t),{},{createAt:x.firestore.FieldValue.serverTimestamp()}))}var w=function(e){for(var t=e.toLowerCase().split(" ").filter((function(e){return e})),n=t.length,a=[],c=[],i=[],s=0;s<n;s++)a[s]=!1;return function e(s){for(var o=0;o<n;o++)a[o]||(a[o]=!0,c[s]=t[o],s===n-1&&i.push(c.join(" ")),e(s+1),a[o]=!1)}(0),i.reduce((function(e,t){var n=function(e){var t=[],n="";return e.split("").forEach((function(e){n+=e,t.push(n)})),t}(t);return[].concat(Object(v.a)(e),Object(v.a)(n))}),[])},C=n(11),R=u.a.Title,N=new x.auth.FacebookAuthProvider;var I,U,k,A,F,L,V,S,T,D,M,z=function(){function e(){return(e=Object(l.a)(r.a.mark((function e(){return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,O.signInWithPopup(N).then((function(e){var t=e.additionalUserInfo,n=e.user;(null===t||void 0===t?void 0:t.isNewUser)&&y("users",{displayName:n.displayName,email:n.email,uid:n.uid,photoURL:n.photoURL,providerID:t.providerId,keywords:w(n.displayName)})})).catch((function(e){console.log(e.message,7e3)}));case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(C.jsx)("div",{children:Object(C.jsx)(d.a,{justify:"center",children:Object(C.jsxs)(j.a,{span:6,children:[Object(C.jsx)(R,{style:{textAlign:"center"},level:3,children:"Chat App"}),Object(C.jsx)(b.a,{style:{width:"100%",marginBottom:8},children:"Sign in with Google"}),Object(C.jsx)(b.a,{style:{width:"100%"},onClick:function(){return e.apply(this,arguments)},children:"Sign in with FaceBook"})]})})})},E=n(47),B=n(285),P=n(288),G=n(48),K=n(20),Y=n(30),J=n(277),q=Object(G.a)(J.a)(I||(I=Object(E.a)(["\n  display: flex;\n  justify-content: center;\n  margin-top: 100px;\n"]))),W=Object(a.createContext)(),H=function(e){var t=e.children,n=Object(Y.f)(),c=Object(a.useState)({}),i=Object(K.a)(c,2),s=i[0],o=i[1],r=Object(a.useState)(!0),l=Object(K.a)(r,2),u=l[0],d=l[1];return Object(a.useEffect)((function(){var e=O.onAuthStateChanged((function(e){if(e){var t=e.email,a=e.displayName,c=e.uid,i=e.photoURL;o({email:t,displayName:a,uid:c,photoURL:i}),d(!1),n("/")}else d(!1),n("/login")}));return function(){e()}}),[n]),Object(C.jsx)(W.Provider,{value:s,children:u?Object(C.jsx)(q,{size:"large"}):t})},Q=G.a.div(U||(U=Object(E.a)(["\n  display: flex;\n  justify-content: space-between;\n  padding: 15px;\n  border-bottom: 1px solid rgba(82, 38, 83);\n  .username {\n    margin-left: 5px;\n    color: white;\n  }\n"]))),Z=function(){var e,t=Object(a.useContext)(W),n=t.displayName,c=t.photoURL;return Object(C.jsxs)(Q,{children:[Object(C.jsxs)("div",{children:[Object(C.jsx)(B.a,{className:"avatar",src:c,style:{backgroundColor:"#f56a00"},children:c?"":null===n||void 0===n||null===(e=n.charAt(0))||void 0===e?void 0:e.toUpperCase()}),Object(C.jsx)(u.a.Text,{className:"username",children:n})]}),Object(C.jsx)(b.a,{ghost:!0,icon:Object(C.jsx)(P.a,{}),onClick:function(){O.signOut()},children:"\u0110\u0103ng xu\u1ea5t"})]})},X=n(282),$=n(287),_=n(7),ee=function(e,t){var n=Object(a.useState)([]),c=Object(K.a)(n,2),i=c[0],s=c[1];return Object(a.useEffect)((function(){var n=f.collection(e).orderBy("createAt");return t&&t.compareValue&&(n=n.where(t.fieldName,t.operator,t.compareValue)),n.onSnapshot((function(e){var t=[];e.forEach((function(e){t.push(Object(g.a)(Object(g.a)({},e.data()),{},Object(_.a)({},"id",e.id)))})),s([].concat(t))}))}),[e,t]),i},te=Object(a.createContext)(),ne=function(e){var t=e.children,n=Object(a.useState)(!1),c=Object(K.a)(n,2),i=c[0],s=c[1],o=Object(a.useState)(!1),r=Object(K.a)(o,2),l=r[0],u=r[1],d=Object(a.useState)(""),j=Object(K.a)(d,2),b=j[0],p=j[1],h=Object(a.useContext)(W).uid,m=Object(a.useMemo)((function(){return{fieldName:"members",operator:"array-contains",compareValue:h}}),[h]),O=ee("rooms",m),f=Object(a.useMemo)((function(){return O.find((function(e){return e.id===b}))}),[b,O]),x=Object(a.useMemo)((function(){return{fieldName:"uid",operator:"in",compareValue:f?f.members:[""]}}),[f]),v=ee("users",x);return Object(C.jsx)(te.Provider,{value:{rooms:O,users:v,selectedRoom:f,isVisibleAddRoom:i,setIsVisibleAddRoom:s,selectedRoomId:b,setSelectedRoomId:p,isVisibleInviteUser:l,setIsVisibleInviteUser:u},children:t})},ae=Object(G.a)(X.a.Panel)(k||(k=Object(E.a)(["\n  &&& {\n    .ant-collapse-header {\n      color: white;\n      padding-bottom: 0;\n    }\n    .ant-typography {\n      display: block;\n      margin: 10px 17px;\n    }\n    .ant-typography:first-child {\n      margin-top: 0;\n    }\n    .ant-collapse-content {\n      padding-left: 7px;\n    }\n    .ant-btn {\n      color: white;\n      &:hover {\n        opacity: 0.8;\n      }\n    }\n  }\n"]))),ce=function(){var e=c.a.useContext(te),t=e.setIsVisibleAddRoom,n=e.setSelectedRoomId,a=e.rooms;return Object(C.jsx)(X.a,{ghost:!0,bordered:!1,defaultActiveKey:["1"],children:Object(C.jsxs)(ae,{header:"Danh s\xe1ch c\xe1c ph\xf2ng",children:[Object(C.jsx)("div",{children:a.map((function(e){return Object(C.jsx)(u.a.Link,{onClick:function(){return t=e.id,void n(t);var t},children:e.name},e.id)}))}),Object(C.jsx)(b.a,{type:"text",onClick:function(){t(!0)},icon:Object(C.jsx)($.a,{}),children:"Th\xeam ph\xf2ng"})]},"1")})},ie=G.a.div(A||(A=Object(E.a)(["\n  background-color: rgb(63, 14, 64);\n  color: white;\n  height: 100vh;\n"]))),se=function(){return Object(C.jsx)(ie,{children:Object(C.jsxs)(d.a,{children:[Object(C.jsx)(j.a,{span:24,children:Object(C.jsx)(Z,{})}),Object(C.jsx)(j.a,{span:24,children:Object(C.jsx)(ce,{})})]})})},oe=n(81),re=n(289),le=G.a.div(F||(F=Object(E.a)(["\n  display: flex;\n  justify-content: space-between;\n  border-bottom: 1px solid rgba(82, 38, 83, 0.1);\n  .header {\n    padding: 5px 10px;\n    .header-title {\n      margin-bottom: 5px;\n    }\n    .header-desc {\n      font-size: 13px;\n    }\n  }\n  .ant-btn {\n    margin-right: 10px;\n  }\n  .user-box {\n    display: flex;\n    align-items: center;\n    .ant-avatar {\n      cursor: pointer;\n    }\n  }\n"]))),ue=function(){var e=Object(a.useContext)(te),t=e.selectedRoom,n=e.users,c=e.setIsVisibleInviteUser,i=t.name,s=t.description;return Object(C.jsxs)(le,{children:[Object(C.jsxs)("div",{className:"header",children:[Object(C.jsx)(u.a.Title,{className:"header-title",level:4,children:i}),Object(C.jsx)(u.a.Text,{className:"header-desc",children:s})]}),Object(C.jsxs)("div",{className:"user-box",children:[Object(C.jsx)(b.a,{shape:"round",icon:Object(C.jsx)(re.a,{}),onClick:function(){c(!0)},children:"M\u1eddi"}),Object(C.jsx)(B.a.Group,{maxCount:3,children:n.map((function(e){var t;return Object(C.jsx)(oe.a,{title:e.displayName,placement:"bottom",children:Object(C.jsx)(B.a,{src:e.photoURL,style:{backgroundColor:"#87d068"},children:e.photoURL?"":null===(t=e.displayName)||void 0===t?void 0:t.charAt(0).toUpperCase()})},e.uid)}))})]})]})},de=n(279),je=n(284),be=n(278),pe=u.a.Text,he=G.a.div(L||(L=Object(E.a)(["\n  display: flex;\n  margin-bottom: 10px;\n  .ant-avatar {\n    margin-right: 8px;\n  }\n  .message-user {\n    font-weight: bold;\n    margin-right: 5px;\n    font-size: 15px;\n  }\n  &.styleRight {\n    margin-left: auto;\n  }\n"]))),me=Object(G.a)(pe)(V||(V=Object(E.a)(["\n  font-size: 10px;\n"]))),Oe=function(e){var t=e.message,n=e.photoURL,a=e.displayName,c=e.createAt,i=e.styleRight;return console.log(i),Object(C.jsxs)(he,{className:i?"styleRight":"",children:[Object(C.jsx)(B.a,{size:30,src:n,children:n?"":null===a||void 0===a?void 0:a.charAt(0).toUpperCase()}),Object(C.jsxs)("div",{className:"message-box",children:[Object(C.jsxs)("div",{className:"message-info",children:[Object(C.jsx)("span",{className:"message-user",children:a}),Object(C.jsx)(me,{type:"secondary",children:function(e){if(e){var t=Object(be.a)(new Date(1e3*e),new Date);return t.charAt(0).toUpperCase()+t.slice("1")}}(null===c||void 0===c?void 0:c.seconds)})]}),Object(C.jsx)("span",{className:"message-text",children:t})]})]})},fe=G.a.div(S||(S=Object(E.a)(["\n  height: calc(100% - 66px);\n  display: flex;\n  flex-flow: column;\n  justify-content: flex-end;\n  align-item: flex-end;\n  padding: 0 10px 10px;\n"]))),xe=G.a.div(T||(T=Object(E.a)(["\n  overflow-y: auto;\n  height: 100%;\n  margin-bottom: 3px;\n  display: flex;\n  flex-flow: column;\n  justify-content: flex-end;\n"]))),ve=G.a.div(D||(D=Object(E.a)(["\n  display: flex;\n  .ant-input-affix-wrapper {\n    padding: 3px 5px;\n  }\n"]))),ge=function(){var e=de.a.useForm(),t=Object(K.a)(e,1)[0],n=Object(a.useContext)(te).selectedRoomId,c=Object(a.useContext)(W),i=c.displayName,s=c.photoURL,o=c.uid,r=Object(a.useRef)();function l(){var e=t.getFieldValue(["message"]);e&&(t.resetFields(),y("message",{roomId:n,displayName:i,photoURL:s,uid:o,message:e}),r.current.focus())}var u=Object(a.useMemo)((function(){return{fieldName:"roomId",operator:"==",compareValue:n}}),[n]),d=ee("message",u);return Object(C.jsxs)(fe,{children:[Object(C.jsx)(xe,{children:d.map((function(e){return Object(C.jsx)(Oe,{styleRight:o===e.uid,message:e.message,photoURL:e.photoURL,displayName:e.displayName,createAt:e.createAt},e.id)}))}),Object(C.jsx)(ve,{children:Object(C.jsx)(de.a,{form:t,style:{width:"100%"},onKeyDown:function(e){"Enter"===e.key&&l()},children:Object(C.jsx)(de.a.Item,{name:"message",children:Object(C.jsx)(je.a,{ref:r,autoFocus:"autofocus",autoComplete:"off",placeholder:"Nh\u1eadp tin nh\u1eafn ...",suffix:Object(C.jsx)(b.a,{type:"primary",onClick:function(){l()},children:"G\u1eedi"})})})})})]})},ye=n(286),we=G.a.div(M||(M=Object(E.a)(["\n  height: 100vh;\n  padding: 5px;\n"]))),Ce=function(){var e=Object(a.useContext)(te).selectedRoom;return Object(C.jsx)(we,{children:e?Object(C.jsxs)(C.Fragment,{children:[Object(C.jsx)(ue,{}),Object(C.jsx)(ge,{})]}):Object(C.jsx)(ye.a,{message:"H\xe3y ch\u1ecdn ph\xf2ng!!",type:"info",closable:!0,showIcon:!0})})},Re=function(){return Object(C.jsx)("div",{children:Object(C.jsxs)(d.a,{children:[Object(C.jsx)(j.a,{span:6,children:Object(C.jsx)(se,{})}),Object(C.jsx)(j.a,{span:18,children:Object(C.jsx)(Ce,{})})]})})},Ne=n(150),Ie=n(283),Ue=function(){var e=Object(a.useContext)(te),t=e.isVisibleAddRoom,n=e.setIsVisibleAddRoom,c=Object(a.useContext)(W).uid,i=de.a.useForm(),s=Object(K.a)(i,1)[0];function o(){try{s.validateFields(["name","description"]).then((function(e){n(!1),s.resetFields(),y("rooms",Object(g.a)(Object(g.a)({},e),{},{members:[c]}))})).catch((function(e){return console.log(e)}))}catch(e){console.log("Failed:",e)}}return Object(C.jsx)(Ie.a,{title:"Th\xeam ph\xf2ng",visible:t,onOk:function(){o()},onCancel:function(){n(!1)},children:Object(C.jsxs)(de.a,{form:s,layout:"vertical",onKeyDown:function(e){"Enter"===e.key&&o()},children:[Object(C.jsx)(de.a.Item,{name:"name",label:"T\xean ph\xf2ng",rules:[{required:!0,message:"Vui l\xf2ng nh\u1eadp t\xean ph\xf2ng"}],children:Object(C.jsx)(je.a,{placeholder:"Nh\u1eadp t\xean ph\xf2ng"})}),Object(C.jsx)(de.a.Item,{name:"description",label:"M\xf4 t\u1ea3",rules:[{required:!0,message:"Vui l\xf2ng nh\u1eadp m\xf4 t\u1ea3"}],children:Object(C.jsx)(je.a,{placeholder:"Nh\u1eadp m\xf4 t\u1ea3"})})]})})},ke=n(187),Ae=n(281),Fe=n(177);function Le(e){var t=e.fetchOptions,n=e.debounceTimeout,c=void 0===n?300:n,i=e.curMembers,s=e.options,o=e.setOptions,r=Object(ke.a)(e,["fetchOptions","debounceTimeout","curMembers","options","setOptions"]),l=Object(a.useState)(!1),u=Object(K.a)(l,2),d=u[0],j=u[1],b=Object(a.useMemo)((function(){return Object(Fe.debounce)((function(e){o([]),j(!0),t(e,i).then((function(e){o(e),j(!1)}))}),c)}),[c,t,i,o]);return Object(a.useEffect)((function(){o([])}),[o]),Object(C.jsx)(Ae.a,Object(g.a)(Object(g.a)({labelInValue:!0,filterOption:!1,onSearch:b,notFoundContent:d?Object(C.jsx)(J.a,{size:"small"}):null},r),{},{children:s.map((function(e){var t,n;return Object(C.jsxs)(Ae.a.Option,{value:e.value,title:e.label,children:[Object(C.jsx)(B.a,{size:"small",src:e.photoURL,children:e.photoURL?"":null===(t=e.label)||void 0===t||null===(n=t.charAt(0))||void 0===n?void 0:n.toUpperCase()})," ".concat(e.label)]},e.value)}))}))}function Ve(e){return e.toLowerCase().split(" ").filter((function(e){return""!==e})).join(" ")}function Se(e,t){return Te.apply(this,arguments)}function Te(){return(Te=Object(l.a)(r.a.mark((function e(t,n){var a;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=Ve(t),e.abrupt("return",f.collection("users").where("keywords","array-contains",a).orderBy("displayName").limit(20).get().then((function(e){return e.docs.map((function(e){return{label:e.data().displayName,value:e.data().uid,photoURL:e.data().photoURL}})).filter((function(e){return!n.includes(e.value)}))})));case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var De=function(){var e=Object(a.useContext)(te),t=e.isVisibleInviteUser,n=e.setIsVisibleInviteUser,c=e.selectedRoomId,i=e.selectedRoom,s=Object(a.useState)([]),o=Object(K.a)(s,2),r=o[0],l=o[1],u=Object(a.useState)([]),d=Object(K.a)(u,2),j=d[0],b=d[1],p=de.a.useForm(),h=Object(K.a)(p,1)[0];return Object(C.jsx)(Ie.a,{title:"M\u1eddi th\xeam th\xe0nh vi\xean",visible:t,onOk:function(){h.resetFields(),l([]),b([]),f.collection("rooms").doc(c).update({members:[].concat(Object(v.a)(i.members),Object(v.a)(r.map((function(e){return e.value}))))}),n(!1)},onCancel:function(){h.resetFields(),l([]),b([]),n(!1)},children:Object(C.jsx)(de.a,{form:h,children:Object(C.jsx)(Le,{options:j,setOptions:b,mode:"multiple",name:"search-user",label:"T\xean c\xe1c th\xe0nh vi\xean",value:r,placeholder:"Nh\u1eadp t\xean th\xe0nh vi\xean",fetchOptions:Se,onChange:function(e){return l(e)},style:{width:"100%"},curMembers:i?i.members:[]})})})};var Me=function(){return Object(C.jsx)(Ne.a,{children:Object(C.jsx)(H,{children:Object(C.jsxs)(ne,{children:[Object(C.jsxs)(Y.c,{children:[Object(C.jsx)(Y.a,{path:"/login",element:Object(C.jsx)(z,{})}),Object(C.jsx)(Y.a,{path:"/",element:Object(C.jsx)(Re,{})})]}),Object(C.jsx)(Ue,{}),Object(C.jsx)(De,{})]})})})},ze=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,290)).then((function(t){var n=t.getCLS,a=t.getFID,c=t.getFCP,i=t.getLCP,s=t.getTTFB;n(e),a(e),c(e),i(e),s(e)}))};s.a.render(Object(C.jsx)(Me,{}),document.getElementById("root")),ze()}},[[272,1,2]]]);
//# sourceMappingURL=main.6d28f290.chunk.js.map